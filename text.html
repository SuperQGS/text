<!DOCTYPE html>
<html>

    <head>
        <style>
            body {
                background-color: black;
            }
            * {
                color: white;
                font-size: 100%;
            }
            #player_input {
                background-color: black;
                border: 0px;
                width: 50%;
                outline-width: 0;
                border-color: black;
            }
        </style>
    </head>

    <body>
        <div id="text">
            <div style="color:blue;">a qgsoftware adventure.</div>
            <div>You wake up.</div>
            <br>

        </div>
        <div>><input type="text" id="player_input"></div>
        <script>
            var input = document.getElementById("player_input");
            var color = "white";
            
            
            window.addEventListener("keydown", upbinds, false);
            function upbinds(u){enter(event)};
            
            function enter(event) {
                
                if (event.keyCode === 13) {
                    var command = document.getElementById("player_input").value
                    var text = document.getElementById("text").innerHTML
                    var response = commandstest(command);
                    document.getElementById("text").innerHTML = text + "<div style='color:grey;'>\> " + command + "</div>" + "<div style=\'color:" + color + ";\'>" + response + "</div><br>";
                    document.getElementById("player_input").value = "";
                    document.getElementById("player_input").scrollIntoView();
                }
            }
            
            
            function commandstest(totest) {
                
                color = "white";
                
                totest = totest.toLowerCase() + " ";
                
                cmd = totest.substring(0, totest.indexOf(" "));
                console.log(cmd)
                
                if (cmd.includes("help") || cmd == "h") {
                    return "help, me, look, grab, use, move, say."
                }
                if (cmd.includes("me") || cmd == "i") {
                    return self();
                }
                if (cmd.includes("look") || cmd == "l") {
                    return level.see;
                }
                if (cmd.includes("grab") || cmd == "g") {
                    return grabfunc(totest);
                }
                if (cmd.includes("use") || cmd == "u") {
                    return usefunc(totest);
                }
                if (cmd.includes("move") || cmd == "m") {
                    return movefunc(totest);
                }
                if (cmd.includes("say") || cmd == "s") {
                    return sayfunc(totest);
                } else {
                     color = "red";
                    return "use \"help\" to see a list of commands."
                }
                
                
            }
                
            //commands
            function self() {
                var inven = items.toString();
                color = "blue";
                return "heath: " + hp + "/100. Inventory:" + inven + ".";
            }
            
            function grabfunc(gquote) {
                var loop = 0;
                while (loop < level.grabs.length) {
                    if (gquote.includes(level.grabs[loop])) {
                        color = "lime";
                        var quotet = "you grabbed the " + level.grabs[loop] + ". Added to inventory."
                        console.log("hi")
                        items[items.length] = level.grabs[loop]
                        level.grabs[loop] = null;
                        return quotet;
                    }
                    loop++
                }
                color = "yellow";
                return "grab what? " + level.grabs.toString()
            }
            
            function usefunc(mquote) {
                var mloop = 0;
                while (mloop < level.uses.length) {
                    if (mquote.includes(level.uses[mloop])) {
                        
                        
                        if (items.includes(level.useitems[mloop])) {
                            color = "lime";
                            var quotet = "you use the " + level.useitems[mloop] + " on the " + level.uses[mloop] + "." + level.usesee[mloop];
                            level.moves[level.moves.length] = level.usetrans[mloop];
                            //remove item!!!
                            
                        } else {
                            color = "red";
                            var quotet = "you try to use the " + level.uses[mloop] + ", but it doesn't work.";
                        }
                        
                        
                        
                        return quotet;
                    }
                    mloop++
                }
                color = "yellow";
                return "use what? " + level.uses.toString()
            }
            
            function movefunc(mquote) {
                var mloop = 0;
                while (mloop < level.moves.length) {
                    if (mquote.includes(level.moves[mloop])) {
                        color = "lime";
                        var quotet = "you moved to the " + level.moves[mloop] + ".";
                        var lvlload = "level =" + level.moves[mloop];
                        eval(lvlload);
                        return quotet;
                    }
                    mloop++
                }
                color = "yellow";
                return "move where? " + level.moves.toString()
            }
            
            function sayfunc(mquote) {
                color = "aqua";
                
                mquote = mquote.slice(mquote.indexOf(" "),mquote.length)
                return "You: " + mquote;
            }
            
            //vars
            var hp = 100
            var items = [" sword", " clothes"]
            
            
            var cave = {
                see: "you are in a cave. There is an opening onto a cliff.",
                grabs: [" rock", " pickaxe", " sock"],
                uses: [],
                useitems: [],
                usetrans: [],
                usesee: [""],
                moves: [ " cliff"],
                talks: [],
                dialogue: []
            }
                
            var cliff = {
                see: "You are on the cliff. An expanse of forests run beneath you. To your left is a path and to your right a shack.",
                grabs: [" flower"],
                uses: [],
                useitems: [],
                usetrans: [],
                usesee: [""],
                moves: [" cave", " path", " shack"],
                talks: [],
                dialogue: []
            }
            
            var shack = {
                see: "You are in front of the shack. It's quite small and looks abandoned.",
                grabs: [],
                uses: [" door"],
                useitems: [" pickaxe"],
                usetrans: [" shack_door"],
                usesee: [" The door smashes open with a loud noise."],
                moves: [" cliff"],
                talks: [],
                dialogue: []
            }
            
            var shack_door = {
                see: "You are inside the shack. It is cold and dark without the fireplace. There is a bed and a table with many items.",
                grabs: [" knife", " leather boots", " magic staff"],
                uses: [" door"],
                useitems: [],
                usetrans: [],
                usesee: [" The door smashes open with a loud noise."],
                moves: [" shack"],
                talks: [],
                dialogue: []
            }
                
            var level;
            level = cave;
        </script>
    </body>

</html>