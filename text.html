<!DOCTYPE html>
<html>

    <head>
        <style>
            body {
                background-color: black;
            }
            * {
                color: white;
            }
            #player_input {
                width: 100%;
                background-color: black;
                border: 0px;
                outline-width: 0;
                border-color: black;
            }
        </style>
    </head>

    <body>
        <div id="text">
            <p>a qgsoftware adventure.
                <p>
                    <p>You wake up.
                        <p>

        </div>
        <br>
        <input type="text" id="player_input">
        <script>
            var input = document.getElementById("player_input");
            input.addEventListener("keyup", function(event) {
                if (event.keyCode === 13) {
                    var command = document.getElementById("player_input").value
                    var text = document.getElementById("text").innerHTML
                    var response = commandstest(command.toLowerCase());
                    document.getElementById("text").innerHTML = text + "<p>\> " + command + "</p>" + "<p>" + response + "</p>";
                    document.getElementById("player_input").value = "";
                    document.getElementById("player_input").scrollIntoView();
                }
            })
            function commandstest(totest) {
                if (totest == "help") {
                    return "help, self, see, grab, use, move, talk."
                }
                if (totest.includes("self")) {
                    return self();
                }
                if (totest.includes("see")) {
                    return level.see;
                }
                if (totest.includes("grab")) {
                    return grabfunc(totest);
                }
                if (totest.includes("use")) {
                    return usefunc(totest);
                }
                if (totest.includes("move")) {
                        return movefunc(totest);
                }
                if (totest.includes("talk")) {
                    return level.talks.toString()
                } else {
                    return "use \"help\" to see a list of commands."
                }
                
                
            }
                
            //commands
            function self() {
                var inven = items.toString();
                return "heath: " + hp + "/100. Inventory:" + inven + ".";
            }
            
            function grabfunc(gquote) {
                var loop = 0;
                while (loop < level.grabs.length) {
                    if (gquote.includes(level.grabs[loop])) {
                        var quotet = "you grabbed the " + level.grabs[loop] + ". Added to inventory."
                        console.log("hi")
                        items[items.length] = level.grabs[loop]
                        level.grabs[loop] = null;
                        return quotet;
                    }
                    loop++
                }
                return "grab what? " + level.grabs.toString()
            }
            
            function usefunc(mquote) {
                var mloop = 0;
                while (mloop < level.uses.length) {
                    if (mquote.includes(level.uses[mloop])) {
                        
                        
                        if (items.includes(level.useitems[mloop])) {
                            var quotet = "you use the " + level.useitems[mloop] + " on the " + level.uses[mloop] + "." + level.usesee[mloop];
                            level.moves[level.moves.length] = level.usetrans[mloop];
                            //remove item!!!
                            
                        } else {
                            var quotet = "you try to use the " + level.uses[mloop] + ", but it doesn't work.";
                        }
                        
                        
                        
                        return quotet;
                    }
                    mloop++
                }
                return "use what? " + level.uses.toString()
            }
            
            function movefunc(mquote) {
                var mloop = 0;
                while (mloop < level.moves.length) {
                    if (mquote.includes(level.moves[mloop])) {
                        var quotet = "you moved to the " + level.moves[mloop] + ".";
                        var lvlload = "level =" + level.moves[mloop];
                        eval(lvlload);
                        return quotet;
                    }
                    mloop++
                }
                return "move where? " + level.moves.toString()
            }
            
            //vars
            var hp = 100
            var items = [" sword", " clothes"]
            
            
            var cave = {
                see: "you are in a cave. There is an opening onto a cliff.",
                grabs: [" rock", " pickaxe"],
                uses: [],
                useitems: [],
                usetrans: [],
                usesee: [""],
                moves: [ " cliff"],
                talks: [],
                dialogue: []
            }
                
            var cliff = {
                see: "You are on the cliff. An expanse of forests run beneath you. To your left is a path and to your right a shack.",
                grabs: [" flower"],
                uses: [],
                useitems: [],
                usetrans: [],
                usesee: [""],
                moves: [" cave", " path", " shack"],
                talks: [],
                dialogue: []
            }
            
            var shack = {
                see: "You are in front of the shack. It's quite small and looks abandoned.",
                grabs: [],
                uses: [" door"],
                useitems: [" pickaxe"],
                usetrans: [" shack_door"],
                usesee: [" The door smashes open with a loud noise."],
                moves: [" cliff"],
                talks: [],
                dialogue: []
            }
            
            var shack_door = {
                see: "You are inside the shack. It is cold and dark without the fireplace. There is a bed and a table with many items.",
                grabs: [" knife", " leather boots", " magic staff"],
                uses: [" door"],
                useitems: [" pickaxe"],
                usetrans: [" shack_door"],
                usesee: [" The door smashes open with a loud noise."],
                moves: [" cliff"],
                talks: [],
                dialogue: []
            }
                
            var level;
            level = cave;
        </script>
    </body>

</html>